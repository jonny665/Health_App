[
  {
    "name": "user_profiles",
    "comment": "用户档案：openid、身高体重、评论、帖子、运动记录",
    "schema": {
      "bsonType": "object",
      "required": [
        "openid",
        "createdAt",
        "updatedAt"
      ],
      "properties": {
        "openid": {
          "bsonType": "string",
          "description": "微信 openid"
        },
        "nickname": {
          "bsonType": "string",
          "maxLength": 50
        },
        "avatar": {
          "bsonType": "string"
        },
        "height": {
          "bsonType": "double",
          "minimum": 0
        },
        "weight": {
          "bsonType": "double",
          "minimum": 0
        },
        "comments": {
          "bsonType": "array",
          "items": {
            "bsonType": "object",
            "required": [
              "content",
              "createdAt"
            ],
            "properties": {
              "content": {
                "bsonType": "string",
                "maxLength": 1000
              },
              "createdAt": {
                "bsonType": "long"
              }
            }
          }
        },
        "posts": {
          "bsonType": "array",
          "items": {
            "bsonType": "object",
            "required": [
              "content",
              "createdAt"
            ],
            "properties": {
              "content": {
                "bsonType": "string",
                "maxLength": 2000
              },
              "createdAt": {
                "bsonType": "long"
              }
            }
          }
        },
        "sportRecords": {
          "bsonType": "array",
          "description": "运动类型、距离、时长记录",
          "items": {
            "bsonType": "object",
            "required": [
              "sportType",
              "distance",
              "duration",
              "recordedAt"
            ],
            "properties": {
              "sportType": {
                "bsonType": "string",
                "maxLength": 50
              },
              "distance": {
                "bsonType": "double",
                "minimum": 0,
                "description": "公里"
              },
              "duration": {
                "bsonType": "int",
                "minimum": 0,
                "description": "分钟"
              },
              "recordedAt": {
                "bsonType": "long"
              }
            }
          }
        },
        "createdAt": {
          "bsonType": "long"
        },
        "updatedAt": {
          "bsonType": "long"
        }
      }
    },
    "indexes": [
      {
        "name": "uk_openid",
        "key": {
          "openid": 1
        },
        "unique": true
      }
    ]
  },
  {
    "name": "messages",
    "comment": "社区留言",
    "schema": {
      "bsonType": "object",
      "required": [
        "content",
        "public",
        "createdAt",
        "clientId"
      ],
      "properties": {
        "content": {
          "bsonType": "string",
          "minLength": 1,
          "maxLength": 1000
        },
        "public": {
          "bsonType": "bool"
        },
        "createdAt": {
          "bsonType": "long"
        },
        "clientId": {
          "bsonType": "string"
        }
      }
    },
    "indexes": [
      {
        "name": "idx_createdAt",
        "key": {
          "createdAt": -1
        }
      },
      {
        "name": "idx_public",
        "key": {
          "public": 1
        }
      }
    ]
  },
  {
    "name": "group",
    "comment": "小组信息",
    "schema": {
      "bsonType": "object",
      "required": [
        "leader",
        "member",
        "groupId",
        "createdAt"
      ],
      "properties": {
        "leader": {
          "bsonType": "string",
          "maxLength": 50
        },
        "info": {
          "bsonType": "string",
          "maxLength": 1000
        },
        "member": {
          "bsonType": "int",
          "minimum": 1
        },
        "groupId": {
          "bsonType": "int",
          "minimum": 1
        },
        "createdAt": {
          "bsonType": "long"
        },
        "clientId": {
          "bsonType": "string"
        }
      }
    },
    "indexes": [
      {
        "name": "uk_groupId",
        "key": {
          "groupId": 1
        },
        "unique": true
      }
    ]
  },
  {
    "name": "form",
    "comment": "小组成员报名",
    "schema": {
      "bsonType": "object",
      "required": [
        "nickname",
        "isLeader",
        "groupId",
        "clientId"
      ],
      "properties": {
        "nickname": {
          "bsonType": "string",
          "maxLength": 50
        },
        "isLeader": {
          "bsonType": "bool"
        },
        "info": {
          "bsonType": "string",
          "maxLength": 1000
        },
        "groupId": {
          "bsonType": "int"
        },
        "clientId": {
          "bsonType": "string"
        }
      }
    },
    "indexes": [
      {
        "name": "idx_groupId",
        "key": {
          "groupId": 1
        }
      }
    ]
  },
  {
    "name": "diet",
    "comment": "饮食记录",
    "schema": {
      "bsonType": "object",
      "required": [
        "food",
        "calories",
        "date",
        "clientId",
        "createdAt"
      ],
      "properties": {
        "food": {
          "bsonType": "string",
          "maxLength": 100
        },
        "calories": {
          "bsonType": "int",
          "minimum": 0
        },
        "date": {
          "bsonType": "string",
          "description": "YYYY-MM-DD"
        },
        "clientId": {
          "bsonType": "string"
        },
        "createdAt": {
          "bsonType": "long"
        }
      }
    },
    "indexes": [
      {
        "name": "idx_client_date",
        "key": {
          "clientId": 1,
          "date": -1
        }
      }
    ]
  },
  {
    "name": "sport",
    "comment": "运动记录",
    "schema": {
      "bsonType": "object",
      "required": [
        "sport",
        "calories",
        "date",
        "clientId",
        "createdAt"
      ],
      "properties": {
        "sport": {
          "bsonType": "string",
          "maxLength": 100
        },
        "calories": {
          "bsonType": "int",
          "minimum": 0
        },
        "date": {
          "bsonType": "string",
          "description": "YYYY-MM-DD"
        },
        "clientId": {
          "bsonType": "string"
        },
        "createdAt": {
          "bsonType": "long"
        }
      }
    },
    "indexes": [
      {
        "name": "idx_client_date",
        "key": {
          "clientId": 1,
          "date": -1
        }
      }
    ]
  },
  {
    "name": "report",
    "comment": "周期报告",
    "schema": {
      "bsonType": "object",
      "required": [
        "start",
        "end",
        "totalDiet",
        "totalSport",
        "clientId",
        "createdAt"
      ],
      "properties": {
        "start": {
          "bsonType": "string"
        },
        "end": {
          "bsonType": "string"
        },
        "totalDiet": {
          "bsonType": "int",
          "minimum": 0
        },
        "totalSport": {
          "bsonType": "int",
          "minimum": 0
        },
        "clientId": {
          "bsonType": "string"
        },
        "createdAt": {
          "bsonType": "long"
        }
      }
    },
    "indexes": [
      {
        "name": "idx_client_createdAt",
        "key": {
          "clientId": 1,
          "createdAt": -1
        }
      }
    ]
  }
]