{"version":3,"file":"diet.js","sources":["pages/diet/diet.vue","../../../hbuilderX/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZGlldC9kaWV0LnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"pd20 column gap\">\r\n    <view class=\"card colorCard\">\r\n      <view class=\"fs36\">今日摄入热量</view>\r\n      <view class=\"fs60 fwb\">{{ total }} kcal</view>\r\n    </view>\r\n    <view class=\"card\">\r\n      <view class=\"fs32 fwb\">记录今日饮食</view>\r\n      <input class=\"input\" v-model=\"food\" placeholder=\"食物名称\" />\r\n      <input\r\n        class=\"input\"\r\n        v-model.number=\"calories\"\r\n        type=\"number\"\r\n        placeholder=\"热量(kcal)\"\r\n      />\r\n      <button class=\"mgt20\" @click=\"addDiet\">添加记录</button>\r\n    </view>\r\n    <view class=\"card\" v-for=\"item in list\" :key=\"item._id\">\r\n      <view class=\"fs32 fwb\">{{ item.food }}</view>\r\n      <view class=\"mgt10 c6\">{{ item.calories }} kcal</view>\r\n      <view class=\"c9 fs24\">{{ item.date }}</view>\r\n    </view>\r\n  </view>\r\n</template>\r\n<script setup>\r\nimport { ref, computed } from \"vue\";\r\nimport { onShow } from \"@dcloudio/uni-app\";\r\nimport { dietService } from \"../../services/api.js\";\r\n\r\nconst food = ref(\"\");\r\nconst calories = ref(0);\r\nconst list = ref([]);\r\n\r\nconst total = computed(() =>\r\n  list.value.reduce((sum, item) => sum + Number(item.calories || 0), 0)\r\n);\r\n\r\nconst load = async () => {\r\n  const today = new Date().toISOString().slice(0, 10);\r\n  try {\r\n    const res = await dietService.dailyDiet(today);\r\n    list.value = res.records || [];\r\n  } catch (e) {\r\n    console.error(e);\r\n  }\r\n};\r\n\r\nconst addDiet = async () => {\r\n  if (!food.value || !calories.value) {\r\n    uni.showToast({ title: \"请填写完整\", icon: \"none\" });\r\n    return;\r\n  }\r\n  try {\r\n    await dietService.addDiet({\r\n      food: food.value,\r\n      calories: Number(calories.value),\r\n      date: new Date().toISOString().slice(0, 10),\r\n    });\r\n    food.value = \"\";\r\n    calories.value = 0;\r\n    await load();\r\n  } catch (e) {\r\n    console.error(e);\r\n  }\r\n};\r\n\r\nonShow(load);\r\n</script>\r\n<style scoped>\r\n.column.gap > .card + .card {\r\n  margin-top: 20rpx;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/Work/unicode/health_app/pages/diet/diet.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","dietService","uni","onShow"],"mappings":";;;;;;AA6BA,UAAM,OAAOA,cAAAA,IAAI,EAAE;AACnB,UAAM,WAAWA,cAAAA,IAAI,CAAC;AACtB,UAAM,OAAOA,cAAAA,IAAI,CAAA,CAAE;AAEnB,UAAM,QAAQC,cAAAA;AAAAA,MAAS,MACrB,KAAK,MAAM,OAAO,CAAC,KAAK,SAAS,MAAM,OAAO,KAAK,YAAY,CAAC,GAAG,CAAC;AAAA,IACtE;AAEA,UAAM,OAAO,YAAY;AACvB,YAAM,SAAQ,oBAAI,QAAO,YAAa,EAAC,MAAM,GAAG,EAAE;AAClD,UAAI;AACF,cAAM,MAAM,MAAMC,aAAAA,YAAY,UAAU,KAAK;AAC7C,aAAK,QAAQ,IAAI,WAAW,CAAA;AAAA,MAC7B,SAAQ,GAAG;AACVC,sBAAAA,kDAAc,CAAC;AAAA,MAChB;AAAA,IACH;AAEA,UAAM,UAAU,YAAY;AAC1B,UAAI,CAAC,KAAK,SAAS,CAAC,SAAS,OAAO;AAClCA,sBAAG,MAAC,UAAU,EAAE,OAAO,SAAS,MAAM,OAAM,CAAE;AAC9C;AAAA,MACD;AACD,UAAI;AACF,cAAMD,aAAAA,YAAY,QAAQ;AAAA,UACxB,MAAM,KAAK;AAAA,UACX,UAAU,OAAO,SAAS,KAAK;AAAA,UAC/B,OAAM,oBAAI,QAAO,YAAa,EAAC,MAAM,GAAG,EAAE;AAAA,QAChD,CAAK;AACD,aAAK,QAAQ;AACb,iBAAS,QAAQ;AACjB,cAAM,KAAI;AAAA,MACX,SAAQ,GAAG;AACVC,sBAAAA,kDAAc,CAAC;AAAA,MAChB;AAAA,IACH;AAEAC,kBAAM,OAAC,IAAI;;;;;;;;;;;;;;;;;;;;;;;;ACjEX,GAAG,WAAW,eAAe;"}