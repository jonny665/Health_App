{"version":3,"file":"community.js","sources":["pages/community/community.vue","../../../hbuilderX/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY29tbXVuaXR5L2NvbW11bml0eS52dWU"],"sourcesContent":["<template>\r\n  <view class=\"pd20 column gap\">\r\n    <view class=\"card\">\r\n      <view class=\"fs32 fwb\">发布你的健康留言</view>\r\n      <textarea\r\n        class=\"input\"\r\n        v-model=\"content\"\r\n        placeholder=\"说点什么...\"\r\n        auto-height\r\n      ></textarea>\r\n      <button class=\"mgt20\" @click=\"publish\">立即发布</button>\r\n    </view>\r\n    <view class=\"card\" v-for=\"m in messages\" :key=\"m._id\">\r\n      <view class=\"fs32\">{{ m.content }}</view>\r\n      <view class=\"c9 fs24 mgt10\">{{ formatTime(m.createdAt) }}</view>\r\n    </view>\r\n  </view>\r\n</template>\r\n<script setup>\r\nimport { ref } from \"vue\";\r\nimport { onShow } from \"@dcloudio/uni-app\";\r\nimport { messageService } from \"../../services/api.js\";\r\n\r\nconst content = ref(\"\");\r\nconst messages = ref([]);\r\n\r\nconst load = async () => {\r\n  try {\r\n    const res = await messageService.listPublic();\r\n    messages.value = res.messages || res.data || [];\r\n  } catch (e) {\r\n    console.error(e);\r\n  }\r\n};\r\n\r\nconst publish = async () => {\r\n  if (!content.value) {\r\n    uni.showToast({ title: \"请输入内容\", icon: \"none\" });\r\n    return;\r\n  }\r\n  try {\r\n    await messageService.publish(content.value);\r\n    content.value = \"\";\r\n    await load();\r\n  } catch (e) {\r\n    console.error(e);\r\n  }\r\n};\r\n\r\nconst formatTime = (ts) => {\r\n  if (!ts) return \"\";\r\n  const date = new Date(ts);\r\n  return `${date.getMonth() + 1}-${date.getDate()} ${date.getHours()}:${String(\r\n    date.getMinutes()\r\n  ).padStart(2, \"0\")}`;\r\n};\r\n\r\nonShow(load);\r\n</script>\r\n<style scoped>\r\n.column.gap > .card + .card {\r\n  margin-top: 20rpx;\r\n}\r\n\r\ntextarea {\r\n  width: 100%;\r\n  min-height: 120rpx;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/Work/unicode/health_app/pages/community/community.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","messageService","uni","onShow"],"mappings":";;;;;;AAuBA,UAAM,UAAUA,cAAAA,IAAI,EAAE;AACtB,UAAM,WAAWA,cAAAA,IAAI,CAAA,CAAE;AAEvB,UAAM,OAAO,YAAY;AACvB,UAAI;AACF,cAAM,MAAM,MAAMC,4BAAe;AACjC,iBAAS,QAAQ,IAAI,YAAY,IAAI,QAAQ;MAC9C,SAAQ,GAAG;AACVC,sBAAAA,4DAAc,CAAC;AAAA,MAChB;AAAA,IACH;AAEA,UAAM,UAAU,YAAY;AAC1B,UAAI,CAAC,QAAQ,OAAO;AAClBA,sBAAG,MAAC,UAAU,EAAE,OAAO,SAAS,MAAM,OAAM,CAAE;AAC9C;AAAA,MACD;AACD,UAAI;AACF,cAAMD,4BAAe,QAAQ,QAAQ,KAAK;AAC1C,gBAAQ,QAAQ;AAChB,cAAM,KAAI;AAAA,MACX,SAAQ,GAAG;AACVC,sBAAAA,4DAAc,CAAC;AAAA,MAChB;AAAA,IACH;AAEA,UAAM,aAAa,CAAC,OAAO;AACzB,UAAI,CAAC;AAAI,eAAO;AAChB,YAAM,OAAO,IAAI,KAAK,EAAE;AACxB,aAAO,GAAG,KAAK,SAAQ,IAAK,CAAC,IAAI,KAAK,QAAO,CAAE,IAAI,KAAK,SAAU,CAAA,IAAI;AAAA,QACpE,KAAK,WAAY;AAAA,MAClB,EAAC,SAAS,GAAG,GAAG,CAAC;AAAA,IACpB;AAEAC,kBAAM,OAAC,IAAI;;;;;;;;;;;;;;;;;;ACxDX,GAAG,WAAW,eAAe;"}